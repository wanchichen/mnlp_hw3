<!DOCTYPE html>
<html lang="en-US" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-beta.51" />
    <meta name="theme" content="VuePress Theme Hope" />
    <meta property="og:url" content="https://lileicc.github.io/blog/dl4mt/2021/lightseq/"><meta property="og:site_name" content="MLNLP Blog"><meta property="og:title" content="Accelerating the Computation on GPUs for Natural Language Processing"><meta property="og:type" content="article"><meta property="og:image" content="https://lileicc.github.io/blog/"><meta property="og:updated_time" content="2022-09-13T03:45:15.000Z"><meta property="og:locale" content="en-US"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:image:alt" content="Accelerating the Computation on GPUs for Natural Language Processing"><meta property="article:author" content="Bowen Zhang"><meta property="article:tag" content="Transformer"><meta property="article:tag" content="GPU Acceleration"><meta property="article:tag" content="CUDA"><meta property="article:published_time" content="2021-12-10T00:00:00.000Z"><meta property="article:modified_time" content="2022-09-13T03:45:15.000Z"><title>Accelerating the Computation on GPUs for Natural Language Processing | MLNLP Blog</title><meta name="description" content="A Blog for Machine Learning, Natural Language Processing, and Data Mining">
    <style>
      :root {
        --bg-color: #fff;
      }

      html[data-theme="dark"] {
        --bg-color: #1d2025;
      }

      html,
      body {
        background-color: var(--bg-color);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.querySelector("html").setAttribute("data-theme", "dark");
      }
    </script>
    <link rel="stylesheet" href="/blog/assets/style.758fbe27.css">
    <link rel="modulepreload" href="/blog/assets/app.4a645708.js"><link rel="modulepreload" href="/blog/assets/index.html.3e1e2bfe.js"><link rel="modulepreload" href="/blog/assets/_plugin-vue_export-helper.cdc0426e.js"><link rel="modulepreload" href="/blog/assets/index.html.9bc33622.js"><link rel="prefetch" href="/blog/assets/index.html.48d72793.js"><link rel="prefetch" href="/blog/assets/index.html.a49e14cc.js"><link rel="prefetch" href="/blog/assets/index.html.84f09450.js"><link rel="prefetch" href="/blog/assets/index.html.7513d19a.js"><link rel="prefetch" href="/blog/assets/index.html.948f6ba7.js"><link rel="prefetch" href="/blog/assets/index.html.4e8ce27b.js"><link rel="prefetch" href="/blog/assets/index.html.cc204d40.js"><link rel="prefetch" href="/blog/assets/index.html.9d3d23de.js"><link rel="prefetch" href="/blog/assets/index.html.e207b34f.js"><link rel="prefetch" href="/blog/assets/index.html.6fe109c4.js"><link rel="prefetch" href="/blog/assets/index.html.f2001ec9.js"><link rel="prefetch" href="/blog/assets/index.html.f13e23f3.js"><link rel="prefetch" href="/blog/assets/index.html.36a209ea.js"><link rel="prefetch" href="/blog/assets/index.html.e51071bb.js"><link rel="prefetch" href="/blog/assets/index.html.3b54c059.js"><link rel="prefetch" href="/blog/assets/index.html.1b2f4c5b.js"><link rel="prefetch" href="/blog/assets/index.html.2693264c.js"><link rel="prefetch" href="/blog/assets/index.html.371141f3.js"><link rel="prefetch" href="/blog/assets/index.html.e3b8fd71.js"><link rel="prefetch" href="/blog/assets/index.html.3cc17b99.js"><link rel="prefetch" href="/blog/assets/index.html.d6d3e578.js"><link rel="prefetch" href="/blog/assets/index.html.9a21b56f.js"><link rel="prefetch" href="/blog/assets/index.html.1f3a298a.js"><link rel="prefetch" href="/blog/assets/404.html.144ea56c.js"><link rel="prefetch" href="/blog/assets/index.html.3a32b4c3.js"><link rel="prefetch" href="/blog/assets/index.html.3eaba85c.js"><link rel="prefetch" href="/blog/assets/index.html.9c8e527a.js"><link rel="prefetch" href="/blog/assets/index.html.949c6932.js"><link rel="prefetch" href="/blog/assets/index.html.9369be8b.js"><link rel="prefetch" href="/blog/assets/index.html.5ecb22f0.js"><link rel="prefetch" href="/blog/assets/index.html.0a31196e.js"><link rel="prefetch" href="/blog/assets/index.html.1b68751c.js"><link rel="prefetch" href="/blog/assets/index.html.85fce0bc.js"><link rel="prefetch" href="/blog/assets/index.html.7d865fc8.js"><link rel="prefetch" href="/blog/assets/index.html.73acbfb4.js"><link rel="prefetch" href="/blog/assets/index.html.7e45f7bf.js"><link rel="prefetch" href="/blog/assets/index.html.620dcedf.js"><link rel="prefetch" href="/blog/assets/index.html.83d0711e.js"><link rel="prefetch" href="/blog/assets/index.html.b4a0aa08.js"><link rel="prefetch" href="/blog/assets/index.html.7adb01cb.js"><link rel="prefetch" href="/blog/assets/index.html.f005e561.js"><link rel="prefetch" href="/blog/assets/index.html.7fb0dc28.js"><link rel="prefetch" href="/blog/assets/index.html.71f8befa.js"><link rel="prefetch" href="/blog/assets/index.html.92c68d7e.js"><link rel="prefetch" href="/blog/assets/index.html.055d7455.js"><link rel="prefetch" href="/blog/assets/index.html.df6f3f04.js"><link rel="prefetch" href="/blog/assets/index.html.00dbedea.js"><link rel="prefetch" href="/blog/assets/index.html.603bf394.js"><link rel="prefetch" href="/blog/assets/index.html.cd4b9e10.js"><link rel="prefetch" href="/blog/assets/index.html.be0f419f.js"><link rel="prefetch" href="/blog/assets/index.html.bc51d0ae.js"><link rel="prefetch" href="/blog/assets/index.html.b79794f0.js"><link rel="prefetch" href="/blog/assets/index.html.eb8e4cee.js"><link rel="prefetch" href="/blog/assets/index.html.5c842c2c.js"><link rel="prefetch" href="/blog/assets/index.html.a95edb3c.js"><link rel="prefetch" href="/blog/assets/index.html.13db0b56.js"><link rel="prefetch" href="/blog/assets/index.html.bad01ddf.js"><link rel="prefetch" href="/blog/assets/index.html.ed77c4d1.js"><link rel="prefetch" href="/blog/assets/index.html.a3514a8d.js"><link rel="prefetch" href="/blog/assets/index.html.65bca0e5.js"><link rel="prefetch" href="/blog/assets/index.html.5bb552c5.js"><link rel="prefetch" href="/blog/assets/index.html.6eb9e54e.js"><link rel="prefetch" href="/blog/assets/index.html.62d61c88.js"><link rel="prefetch" href="/blog/assets/index.html.1362a299.js"><link rel="prefetch" href="/blog/assets/index.html.68f9bc07.js"><link rel="prefetch" href="/blog/assets/index.html.0272cd41.js"><link rel="prefetch" href="/blog/assets/index.html.3b47eb32.js"><link rel="prefetch" href="/blog/assets/index.html.d8dad1e7.js"><link rel="prefetch" href="/blog/assets/index.html.f01de255.js"><link rel="prefetch" href="/blog/assets/index.html.415c7585.js"><link rel="prefetch" href="/blog/assets/index.html.c876a430.js"><link rel="prefetch" href="/blog/assets/index.html.1b3b1bb2.js"><link rel="prefetch" href="/blog/assets/index.html.d1ba8a2a.js"><link rel="prefetch" href="/blog/assets/index.html.ba6b6066.js"><link rel="prefetch" href="/blog/assets/index.html.59861a75.js"><link rel="prefetch" href="/blog/assets/index.html.37e44878.js"><link rel="prefetch" href="/blog/assets/index.html.f61ca0f7.js"><link rel="prefetch" href="/blog/assets/index.html.8fd57ead.js"><link rel="prefetch" href="/blog/assets/index.html.1d75e0d7.js"><link rel="prefetch" href="/blog/assets/index.html.67b586be.js"><link rel="prefetch" href="/blog/assets/index.html.6b468b17.js"><link rel="prefetch" href="/blog/assets/index.html.ec88d877.js"><link rel="prefetch" href="/blog/assets/index.html.b9fddecd.js"><link rel="prefetch" href="/blog/assets/index.html.136b3991.js"><link rel="prefetch" href="/blog/assets/index.html.9f212efc.js"><link rel="prefetch" href="/blog/assets/index.html.edab7849.js"><link rel="prefetch" href="/blog/assets/index.html.3b1c2171.js"><link rel="prefetch" href="/blog/assets/index.html.a3ac0506.js"><link rel="prefetch" href="/blog/assets/index.html.8171ef25.js"><link rel="prefetch" href="/blog/assets/index.html.1e91f5fa.js"><link rel="prefetch" href="/blog/assets/index.html.2567ea47.js"><link rel="prefetch" href="/blog/assets/index.html.34179bc0.js"><link rel="prefetch" href="/blog/assets/index.html.07dd5142.js"><link rel="prefetch" href="/blog/assets/index.html.6e207c32.js"><link rel="prefetch" href="/blog/assets/index.html.e66e9084.js"><link rel="prefetch" href="/blog/assets/index.html.f68d02e9.js"><link rel="prefetch" href="/blog/assets/index.html.0170af13.js"><link rel="prefetch" href="/blog/assets/index.html.a0fad824.js"><link rel="prefetch" href="/blog/assets/404.html.bb5ce50d.js"><link rel="prefetch" href="/blog/assets/index.html.d25d3e45.js"><link rel="prefetch" href="/blog/assets/index.html.3c7083fc.js"><link rel="prefetch" href="/blog/assets/index.html.311c6849.js"><link rel="prefetch" href="/blog/assets/index.html.b97be9de.js"><link rel="prefetch" href="/blog/assets/index.html.1404e446.js"><link rel="prefetch" href="/blog/assets/index.html.478e9de3.js"><link rel="prefetch" href="/blog/assets/index.html.fad58c0c.js"><link rel="prefetch" href="/blog/assets/index.html.b5230444.js"><link rel="prefetch" href="/blog/assets/index.html.e59bc402.js"><link rel="prefetch" href="/blog/assets/index.html.a8bd35ae.js"><link rel="prefetch" href="/blog/assets/index.html.55416fe3.js"><link rel="prefetch" href="/blog/assets/index.html.dee446ce.js"><link rel="prefetch" href="/blog/assets/index.html.b1e6a269.js"><link rel="prefetch" href="/blog/assets/index.html.baf64357.js"><link rel="prefetch" href="/blog/assets/index.html.8350ec77.js"><link rel="prefetch" href="/blog/assets/index.html.bd651257.js"><link rel="prefetch" href="/blog/assets/index.html.df57d3ef.js"><link rel="prefetch" href="/blog/assets/index.html.a04b4e88.js"><link rel="prefetch" href="/blog/assets/index.html.5b3b35f7.js"><link rel="prefetch" href="/blog/assets/index.html.bf11daf8.js"><link rel="prefetch" href="/blog/assets/index.html.5cd8c87a.js"><link rel="prefetch" href="/blog/assets/index.html.0ea67a10.js"><link rel="prefetch" href="/blog/assets/index.html.f8ce58db.js"><link rel="prefetch" href="/blog/assets/index.html.b5a08197.js"><link rel="prefetch" href="/blog/assets/index.html.4c29b9a7.js"><link rel="prefetch" href="/blog/assets/index.html.5e9f59d7.js"><link rel="prefetch" href="/blog/assets/index.html.1b716da2.js"><link rel="prefetch" href="/blog/assets/index.html.0799ac9b.js"><link rel="prefetch" href="/blog/assets/index.html.7638ba74.js"><link rel="prefetch" href="/blog/assets/index.html.0521c2e3.js"><link rel="prefetch" href="/blog/assets/index.html.ac8ae03e.js"><link rel="prefetch" href="/blog/assets/index.html.dff0760b.js"><link rel="prefetch" href="/blog/assets/index.html.87a64487.js"><link rel="prefetch" href="/blog/assets/index.html.20ae52d7.js"><link rel="prefetch" href="/blog/assets/index.html.c2cf0552.js"><link rel="prefetch" href="/blog/assets/index.html.daeb6ccb.js"><link rel="prefetch" href="/blog/assets/index.html.d662a319.js"><link rel="prefetch" href="/blog/assets/index.html.ed066fbd.js"><link rel="prefetch" href="/blog/assets/index.html.c34d89d0.js"><link rel="prefetch" href="/blog/assets/index.html.4bf58d23.js"><link rel="prefetch" href="/blog/assets/index.html.6b48961d.js"><link rel="prefetch" href="/blog/assets/index.html.250aedc4.js"><link rel="prefetch" href="/blog/assets/index.html.2fb73d6d.js"><link rel="prefetch" href="/blog/assets/index.html.71433153.js"><link rel="prefetch" href="/blog/assets/index.html.c21cb6c2.js"><link rel="prefetch" href="/blog/assets/index.html.e515aa55.js"><link rel="prefetch" href="/blog/assets/index.html.0f5a3610.js"><link rel="prefetch" href="/blog/assets/index.html.7644a494.js"><link rel="prefetch" href="/blog/assets/index.html.d3b11d9c.js"><link rel="prefetch" href="/blog/assets/index.html.f19c87f9.js"><link rel="prefetch" href="/blog/assets/index.html.29ef0bb3.js"><link rel="prefetch" href="/blog/assets/giscus.15440425.js"><link rel="prefetch" href="/blog/assets/highlight.esm.d982e650.js"><link rel="prefetch" href="/blog/assets/markdown.esm.832a189d.js"><link rel="prefetch" href="/blog/assets/math.esm.a3f84b6f.js"><link rel="prefetch" href="/blog/assets/notes.esm.3c361cb7.js"><link rel="prefetch" href="/blog/assets/reveal.esm.b96f05d8.js"><link rel="prefetch" href="/blog/assets/search.esm.80da4a02.js"><link rel="prefetch" href="/blog/assets/zoom.esm.8514a202.js"><link rel="prefetch" href="/blog/assets/photoswipe.esm.382b1873.js">
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="skip-link sr-only">Skip to content</a><!--]--><div class="theme-container no-sidebar has-toc"><!--[--><!--[--><header class="navbar"><div class="navbar-left"><button class="toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!----><a href="/blog/" class="brand"><img class="logo" src="/blog/logo.svg" alt="MLNLP Blog"><!----><span class="site-name hide-in-pad">MLNLP Blog</span></a><!----></div><div class="navbar-center"><!----><nav class="nav-links"><div class="nav-item hide-in-mobile"><a href="/blog/" class="nav-link" aria-label="Blog Home"><span class="icon iconfont icon-home"></span>Blog Home<!----></a></div><div class="nav-item hide-in-mobile"><a href="/blog/category/" class="nav-link" aria-label="Category"><span class="icon iconfont icon-categoryselected"></span>Category<!----></a></div><div class="nav-item hide-in-mobile"><a href="/blog/tag/" class="nav-link" aria-label="Tags"><span class="icon iconfont icon-tag"></span>Tags<!----></a></div><div class="nav-item hide-in-mobile"><a href="/blog/timeline/" class="nav-link" aria-label="Timeline"><span class="icon iconfont icon-time"></span>Timeline<!----></a></div></nav><!----></div><div class="navbar-right"><!----><!----><div class="nav-item"><a class="repo-link" href="https://github.com/lileicc/blog" target="_blank" rel="noopener noreferrer" aria-label="GitHub"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="github icon" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></svg></a></div><div class="nav-item hide-in-mobile"><button id="appearance-switch"><svg xmlns="http://www.w3.org/2000/svg" class="icon auto-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="auto icon" style="display:block;"><path d="M512 992C246.92 992 32 777.08 32 512S246.92 32 512 32s480 214.92 480 480-214.92 480-480 480zm0-840c-198.78 0-360 161.22-360 360 0 198.84 161.22 360 360 360s360-161.16 360-360c0-198.78-161.22-360-360-360zm0 660V212c165.72 0 300 134.34 300 300 0 165.72-134.28 300-300 300z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon dark-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="dark icon" style="display:none;"><path d="M524.8 938.667h-4.267a439.893 439.893 0 0 1-313.173-134.4 446.293 446.293 0 0 1-11.093-597.334A432.213 432.213 0 0 1 366.933 90.027a42.667 42.667 0 0 1 45.227 9.386 42.667 42.667 0 0 1 10.24 42.667 358.4 358.4 0 0 0 82.773 375.893 361.387 361.387 0 0 0 376.747 82.774 42.667 42.667 0 0 1 54.187 55.04 433.493 433.493 0 0 1-99.84 154.88 438.613 438.613 0 0 1-311.467 128z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon light-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="light icon" style="display:none;"><path d="M952 552h-80a40 40 0 0 1 0-80h80a40 40 0 0 1 0 80zM801.88 280.08a41 41 0 0 1-57.96-57.96l57.96-58a41.04 41.04 0 0 1 58 58l-58 57.96zM512 752a240 240 0 1 1 0-480 240 240 0 0 1 0 480zm0-560a40 40 0 0 1-40-40V72a40 40 0 0 1 80 0v80a40 40 0 0 1-40 40zm-289.88 88.08-58-57.96a41.04 41.04 0 0 1 58-58l57.96 58a41 41 0 0 1-57.96 57.96zM192 512a40 40 0 0 1-40 40H72a40 40 0 0 1 0-80h80a40 40 0 0 1 40 40zm30.12 231.92a41 41 0 0 1 57.96 57.96l-57.96 58a41.04 41.04 0 0 1-58-58l58-57.96zM512 832a40 40 0 0 1 40 40v80a40 40 0 0 1-80 0v-80a40 40 0 0 1 40-40zm289.88-88.08 58 57.96a41.04 41.04 0 0 1-58 58l-57.96-58a41 41 0 0 1 57.96-57.96z"></path></svg></button></div><form class="search-box" role="search"><input type="search" autocomplete="off" spellcheck="false" value><!----></form><!----><button class="toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span class="button-container"><span class="button-top"></span><span class="button-middle"></span><span class="button-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow left"></span></div><aside class="sidebar"><!--[--><!----><!--]--><ul class="sidebar-links"></ul><!--[--><!----><!--]--></aside><!--[--><main class="page" id="main-content"><!--[--><!----><nav class="breadcrumb disable"></nav><div class="page-title"><h1><!---->Accelerating the Computation on GPUs for Natural Language Processing</h1><div class="page-info"><span class="author-info" aria-label="Author🖊" data-balloon-pos="down" localizeddate="December 10, 2021" isoriginal="false" pageview="false"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="author icon"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><span class="author-item">Bowen Zhang</span></span><span property="author" content="Bowen Zhang"></span></span><!----><span class="date-info" aria-label="Writing Date📅" data-balloon-pos="down" isoriginal="false" pageview="false"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span>December 10, 2021</span><meta property="datePublished" content="2021-12-10T00:00:00.000Z"></span><span class="category-info" aria-label="Category🌈" data-balloon-pos="down" localizeddate="December 10, 2021" isoriginal="false" pageview="false"><svg xmlns="http://www.w3.org/2000/svg" class="icon category-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="category icon"><path d="M148.41 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H148.41c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.311-40.31zM147.556 553.478H429.73c22.263 0 40.311 18.048 40.311 40.31v282.176c0 22.263-18.048 40.312-40.31 40.312H147.555c-22.263 0-40.311-18.049-40.311-40.312V593.79c0-22.263 18.048-40.311 40.31-40.311zM593.927 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H593.927c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.31-40.31zM730.22 920.502H623.926c-40.925 0-74.22-33.388-74.22-74.425V623.992c0-41.038 33.387-74.424 74.425-74.424h222.085c41.038 0 74.424 33.226 74.424 74.067v114.233c0 10.244-8.304 18.548-18.547 18.548s-18.548-8.304-18.548-18.548V623.635c0-20.388-16.746-36.974-37.33-36.974H624.13c-20.585 0-37.331 16.747-37.331 37.33v222.086c0 20.585 16.654 37.331 37.126 37.331H730.22c10.243 0 18.547 8.304 18.547 18.547 0 10.244-8.304 18.547-18.547 18.547z"></path></svg><ul class="categories-wrapper"><li class="category category8 clickable" role="navigation">NLP</li><li class="category category1 clickable" role="navigation">DL4MT</li><meta property="articleSection" content="NLP,DL4MT"></ul></span><span aria-label="Tag🏷" data-balloon-pos="down" localizeddate="December 10, 2021" isoriginal="false" pageview="false"><svg xmlns="http://www.w3.org/2000/svg" class="icon tag-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="tag icon"><path d="M939.902 458.563L910.17 144.567c-1.507-16.272-14.465-29.13-30.737-30.737L565.438 84.098h-.402c-3.215 0-5.726 1.005-7.634 2.913l-470.39 470.39a10.004 10.004 0 000 14.164l365.423 365.424c1.909 1.908 4.42 2.913 7.132 2.913s5.223-1.005 7.132-2.913l470.39-470.39c2.01-2.11 3.014-5.023 2.813-8.036zm-240.067-72.121c-35.458 0-64.286-28.828-64.286-64.286s28.828-64.285 64.286-64.285 64.286 28.828 64.286 64.285-28.829 64.286-64.286 64.286z"></path></svg><ul class="tags-wrapper"><li class="tag tag1 clickable" role="navigation">Transformer</li><li class="tag tag8 clickable" role="navigation">GPU Acceleration</li><li class="tag tag4 clickable" role="navigation">CUDA</li></ul><meta property="keywords" content="Transformer,GPU Acceleration,CUDA"></span><span class="reading-time-info" aria-label="Reading Time⌛" data-balloon-pos="down" localizeddate="December 10, 2021" isoriginal="false" pageview="false"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="timer icon"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>About 4 min</span><meta property="timeRequired" content="PT4M"></span></div><hr></div><div class="toc-place-holder"><aside id="toc"><div class="toc-header">On This Page</div><div class="toc-wrapper"><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/blog/dl4mt/2021/lightseq/#_1-what-is-lightseq" class="router-link-active router-link-exact-active toc-link level2">1. What is LightSeq?</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/blog/dl4mt/2021/lightseq/#_1-1-nlp-models" class="router-link-active router-link-exact-active toc-link level3">1.1 NLP models</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/blog/dl4mt/2021/lightseq/#_1-2-motivation" class="router-link-active router-link-exact-active toc-link level3">1.2 Motivation</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/blog/dl4mt/2021/lightseq/#_1-3-lightseq" class="router-link-active router-link-exact-active toc-link level3">1.3 Lightseq</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/blog/dl4mt/2021/lightseq/#_2-technique-details" class="router-link-active router-link-exact-active toc-link level2">2. Technique Details</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/blog/dl4mt/2021/lightseq/#_2-1-operation-fusion" class="router-link-active router-link-exact-active toc-link level3">2.1 Operation Fusion</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/blog/dl4mt/2021/lightseq/#_2-2-hierarchical-auto-regressive-search" class="router-link-active router-link-exact-active toc-link level3">2.2 Hierarchical Auto-Regressive Search</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/blog/dl4mt/2021/lightseq/#_2-3-dynamic-gpu-memory-reuse" class="router-link-active router-link-exact-active toc-link level3">2.3 Dynamic GPU Memory Reuse</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/blog/dl4mt/2021/lightseq/#_3-using-lightseq" class="router-link-active router-link-exact-active toc-link level2">3. Using LightSeq</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/blog/dl4mt/2021/lightseq/#_3-1-installation" class="router-link-active router-link-exact-active toc-link level3">3.1 Installation</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/blog/dl4mt/2021/lightseq/#_3-2-training-examples-using-lightseq" class="router-link-active router-link-exact-active toc-link level3">3.2 Training examples using LightSeq</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/blog/dl4mt/2021/lightseq/#_3-3-inference-examples-using-lightseq" class="router-link-active router-link-exact-active toc-link level3">3.3 Inference examples Using LightSeq</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/blog/dl4mt/2021/lightseq/#_4-performance" class="router-link-active router-link-exact-active toc-link level2">4. Performance</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/blog/dl4mt/2021/lightseq/#_4-1-training-performance" class="router-link-active router-link-exact-active toc-link level3">4.1 Training Performance</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/blog/dl4mt/2021/lightseq/#_4-2-inference-performance" class="router-link-active router-link-exact-active toc-link level3">4.2 Inference Performance</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/blog/dl4mt/2021/lightseq/#_4-3-more-inference-performance-on-nvidia-p4-and-t4" class="router-link-active router-link-exact-active toc-link level3">4.3 More Inference Performance on Nvidia P4 and T4</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/blog/dl4mt/2021/lightseq/#_4-4-real-world-cloud-computing-delay-test-on-gpt" class="router-link-active router-link-exact-active toc-link level3">4.4 Real-world Cloud Computing Delay Test on GPT</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/blog/dl4mt/2021/lightseq/#_5-reference" class="router-link-active router-link-exact-active toc-link level2">5. Reference</a></li><!----><!--]--></ul></div></aside></div><!----><div class="theme-hope-content"><p>A high performance open-source library for NLP Transformer model training and inferencing.</p><!-- more --><h2 id="_1-what-is-lightseq" tabindex="-1"><a class="header-anchor" href="#_1-what-is-lightseq" aria-hidden="true">#</a> 1. What is LightSeq?</h2><p><img src="/blog/assets/lightseqlogo.cec12a01.png" alt="logo"></p><h3 id="_1-1-nlp-models" tabindex="-1"><a class="header-anchor" href="#_1-1-nlp-models" aria-hidden="true">#</a> 1.1 NLP models</h3><p>Transformers[1], BERT[2], or GPT[3] models are state-of-art models on natural language processing tasks. They are heavily used and breaking multiple records on sequence-to-sequence (Seq2Seq) tasks including machine translation, text summarization, and text generation, or even computer vision tasks by Vision Transformers (an image is just a sequence of pixels). However, those models are huge in size that needs large-scale training and inference. This makes it computationally expensive, so serving these models is a challenge for real industrial applications.</p><h3 id="_1-2-motivation" tabindex="-1"><a class="header-anchor" href="#_1-2-motivation" aria-hidden="true">#</a> 1.2 Motivation</h3><p>Due to the high complexity and large parameter size of transformer models, the latency for both training and inference is high. Here are the three comparisons between the current inference systems and LightSeq, and the reasons why they are not able to perform well for online tasks.</p><ol><li>Popular deep learning frameworks. Since those models have flexible model structures, both TensorFlow and PyTorch need additional memory allocation and extra overhead for training. Thus, they do not make full use of the hardware resource.</li><li>Inference optimization frameworks. Optimization frameworks like TensorFlow XLA, TVM, and TensorRT are not suitable for variable-length inputs, which require dynamic memory allocation that does not perform well for transformer models.</li><li>Similar acceleration frameworks. Faster-Transformer and TurboTransformers are similar to LightSeq. However, they do not have all components or features compared to LightSeq (Table 1).</li></ol><h3 id="_1-3-lightseq" tabindex="-1"><a class="header-anchor" href="#_1-3-lightseq" aria-hidden="true">#</a> 1.3 Lightseq</h3><p>LightSeq[4], is a high-performance open-source library for both training and inference that is directly built on top of CUDA official libraries (<a href="https://docs.nvidia.com/cuda/cublas/index.html" target="_blank" rel="noopener noreferrer">cuBLAS<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>, <a href="https://docs.nvidia.com/cuda/thrust/index.html" target="_blank" rel="noopener noreferrer">Thrust<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>, <a href="http://nvlabs.github.io/cub/" target="_blank" rel="noopener noreferrer">CUB<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>). It supports models in the Transformer family including BERT, GPT, and full encoder-decoder. It introduces new transformer encoders and decoders components after fusing and optimizing the existing models.</p><p>The applications of LightSeq include Machine Translation, Text Generation, Dialog, Language Modelling, Sentiment Analysis, and other related tasks with sequence data, which can be easily deployed to commercial products.</p><p>LightSeq improves the speed for both training and inference stages. Models like DeepSpeed[5] only accelerate the training, and tools like TensorRT, FasterTransformer, or TurboTransformers only support optimizing the inference. Here are the comparison tables on different features between LightSeq and other models.</p><p><img src="/blog/assets/feature_table.41bcda19.png" alt="Features"></p><p>Table 1. The tables above are from the <a href="https://github.com/bytedance/lightseq" target="_blank" rel="noopener noreferrer">official Github repository<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>.</p><h2 id="_2-technique-details" tabindex="-1"><a class="header-anchor" href="#_2-technique-details" aria-hidden="true">#</a> 2. Technique Details</h2><p>There are three main methods that LightSeq uses to optimize the model, training speed, and inference speed. The image below shows the architecture of a sequence-to-sequence model using transformers.</p><p><img src="/blog/assets/Transformer.9788bc51.png" alt="Transformer"></p><h3 id="_2-1-operation-fusion" tabindex="-1"><a class="header-anchor" href="#_2-1-operation-fusion" aria-hidden="true">#</a> 2.1 Operation Fusion</h3><p>Transformers model implemented by popular deep learning frameworks like Pytorch or Tensorflow just combine multiple fine-grained kernel functions for one layer. In this way, it needs to launch more kernel functions and uses lots of memory I/O that costs extra time for training and inference.</p><p>LightSeq uses general matrix multiply (GEMM) and custom kernel functions, so here are only six custom kernel functions and six GEMM in a Transformer encoder layer for LightSeq models. The right image shows the model structure of the LightSeq transformer encoder layer.</p><p><em>Need to add more intuitive description here</em><img src="/blog/assets/fusion.fec4fb2f.png" alt="Fusion"></p><h3 id="_2-2-hierarchical-auto-regressive-search" tabindex="-1"><a class="header-anchor" href="#_2-2-hierarchical-auto-regressive-search" aria-hidden="true">#</a> 2.2 Hierarchical Auto-Regressive Search</h3><p>Searching usually happens in the last step of a transformer model. Redundant calculations often exist in output layers since we only need a few labels/tokens with the highest probability instead of all of them.</p><p>LightSeq optimizes this process by using a Hierarchical Auto Regressive Search method to erase redundant calculations and perform parallel computing illustrated as below (using beam search as an example).</p><p>the following steps happen for each beam.</p><ol><li>Randomly divide logits into k groups</li><li>Calculate the maximum of group <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span>, denoted as <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>m</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">m_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></li><li>Calculate the minimum of <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>m</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">m_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>, denoted as <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi></mrow><annotation encoding="application/x-tex">R</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span>, which can be regarded as a rough top-k value of logits.</li><li>Select logits larger than <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi></mrow><annotation encoding="application/x-tex">R</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span> and write them into GPU memory.</li></ol><p><img src="/blog/assets/softmax.bda42797.png" alt="softmax"></p><h3 id="_2-3-dynamic-gpu-memory-reuse" tabindex="-1"><a class="header-anchor" href="#_2-3-dynamic-gpu-memory-reuse" aria-hidden="true">#</a> 2.3 Dynamic GPU Memory Reuse</h3><p>LightSeq pre-defines the maximum of dynamic shapes, such as the maximal sequence length, to avoid memory allocation time and save GPU memory occupancy. Also, GPU memory is shared for non-dependent intermediate results to reduce the memory usage.</p><p>By using LightSeq, users are able to 8 Transformer big models simultaneously on a NVIDIA Tesla T4 GPU.</p><h2 id="_3-using-lightseq" tabindex="-1"><a class="header-anchor" href="#_3-using-lightseq" aria-hidden="true">#</a> 3. Using LightSeq</h2><p>Running LightSeq requires one or more GPUs.</p><h3 id="_3-1-installation" tabindex="-1"><a class="header-anchor" href="#_3-1-installation" aria-hidden="true">#</a> 3.1 Installation</h3><p>LightSeq installation from PyPI only supports python 3.6 to 3.8 on Linux for now. Consider compiling from source if you have other environments.</p><p><code>pip install lightseq fairseq sacremoses transformers</code></p><h3 id="_3-2-training-examples-using-lightseq" tabindex="-1"><a class="header-anchor" href="#_3-2-training-examples-using-lightseq" aria-hidden="true">#</a> 3.2 Training examples using LightSeq</h3><p>Training a translation task on wmt14 en2de dataset by running the following command.</p><p><code>sh examples/training/fairseq/ls_fairseq_wmt14en2de.sh</code></p><p>If you want to run the training using FairSeq, run the following command.</p><p><code>sh examples/training/fairseq/fairseq_wmt14en2de.sh</code></p><h3 id="_3-3-inference-examples-using-lightseq" tabindex="-1"><a class="header-anchor" href="#_3-3-inference-examples-using-lightseq" aria-hidden="true">#</a> 3.3 Inference examples Using LightSeq</h3><p><code>pip install torch tensorflow transformers lightseq</code></p><p><code>cd examples/inference/python</code></p><p><code>python export/hf_bart_export.py</code></p><p><code>python test/ls_bart.py</code></p><p><a href="https://github.com/bytedance/lightseq/blob/master/docs/guide.md" target="_blank" rel="noopener noreferrer">Here<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> is a guide on using LightSeq for training and inference.</p><h2 id="_4-performance" tabindex="-1"><a class="header-anchor" href="#_4-performance" aria-hidden="true">#</a> 4. Performance</h2><h3 id="_4-1-training-performance" tabindex="-1"><a class="header-anchor" href="#_4-1-training-performance" aria-hidden="true">#</a> 4.1 Training Performance</h3><p>The plots below are the experiment results on WMT14 English to German translation tasks using Transformer-Big models. In all plots, FairSeq+LightSeq models are able to improve the performance to 3.5X maximum.</p><p><img src="/blog/assets/training_speed.39a85158.png" alt="Training"></p><p>The image above is from the <a href="https://github.com/bytedance/lightseq" target="_blank" rel="noopener noreferrer">official Github repository<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>.</p><h3 id="_4-2-inference-performance" tabindex="-1"><a class="header-anchor" href="#_4-2-inference-performance" aria-hidden="true">#</a> 4.2 Inference Performance</h3><p>Here are the inference results using LightSeq, TensorFlow, PyTorch, and FasterTransformer on neural machine translation using Transformer-base models with beam search methods.</p><p><img src="/blog/assets/inference_speed.2d669fb6.png" alt="Inference"></p><p>The image above is from the <a href="https://github.com/bytedance/lightseq" target="_blank" rel="noopener noreferrer">official Github repository<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>.</p><h3 id="_4-3-more-inference-performance-on-nvidia-p4-and-t4" tabindex="-1"><a class="header-anchor" href="#_4-3-more-inference-performance-on-nvidia-p4-and-t4" aria-hidden="true">#</a> 4.3 More Inference Performance on Nvidia P4 and T4</h3><p>The three images below are from the <a href="https://segmentfault.com/a/1190000038523998" target="_blank" rel="noopener noreferrer">Volctrans Blog on segmentfault.com<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>.</p><p>X-axes are the Batch size and sequence length pairs, and Y-axes are the acceleration rates.</p><p><img src="/blog/assets/beamsearch.843e76a0.png" alt="Beam Search T4"></p><p><img src="/blog/assets/beamsearchp4.0d8d1658.png" alt="Beam Search P4"></p><p><img src="/blog/assets/samplingp4.5532986d.png" alt="Sampling"></p><h3 id="_4-4-real-world-cloud-computing-delay-test-on-gpt" tabindex="-1"><a class="header-anchor" href="#_4-4-real-world-cloud-computing-delay-test-on-gpt" aria-hidden="true">#</a> 4.4 Real-world Cloud Computing Delay Test on GPT</h3><p>This plot shows the performance of deploying a GPT model to cloud computing. At 11:00, the delay performance decreased from 360 ms to 80 ms when LightSeq is turned on.</p><p><img src="/blog/assets/realworkload.ad7c6804.png" alt="Real Work Load"></p><p>The image above is from the <a href="https://segmentfault.com/a/1190000038523998" target="_blank" rel="noopener noreferrer">Volctrans Blog on segmentfault.com<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>.</p><h2 id="_5-reference" tabindex="-1"><a class="header-anchor" href="#_5-reference" aria-hidden="true">#</a> 5. Reference</h2><p>[1] Vaswani, Ashish, et al. &quot;Attention is all you need.&quot; Advances in neural information processing systems. 2017.</p><p>[2] Devlin, Jacob, et al. &quot;Bert: Pre-training of deep bidirectional transformers for language understanding.&quot; <em>arXiv preprint arXiv:1810.04805</em> (2018).</p><p>[3] Brown, Tom B., et al. &quot;Language models are few-shot learners.&quot; arXiv preprint arXiv:2005.14165 (2020).</p><p>[4] Wang, Xiaohui, et al. &quot;LightSeq: A High Performance Inference Library for Transformers.&quot; arXiv preprint arXiv:2010.13887 (2020).</p><p>[5] Jeff Rasley, Samyam Rajbhandari, Olatunji Ruwase, and Yuxiong He. (2020) DeepSpeed: System Optimizations Enable Training Deep Learning Models with Over 100 Billion Parameters. <a href="https://dl.acm.org/doi/10.1145/3394486.3406703" target="_blank" rel="noopener noreferrer">In Proceedings of the 26th ACM SIGKDD International Conference on Knowledge Discovery &amp; Data Mining (KDD &#39;20, Tutorial)<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>.</p></div><!----><footer class="page-meta"><div class="meta-item edit-link"><a href="https://github.com/lileicc/blog/edit/main/dl4mt/2021/lightseq/README.md" rel="noopener noreferrer" target="_blank" aria-label="Edit this page" class="nav-link label"><!--[--><svg xmlns="http://www.w3.org/2000/svg" class="icon edit-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="edit icon"><path d="M430.818 653.65a60.46 60.46 0 0 1-50.96-93.281l71.69-114.012 7.773-10.365L816.038 80.138A60.46 60.46 0 0 1 859.225 62a60.46 60.46 0 0 1 43.186 18.138l43.186 43.186a60.46 60.46 0 0 1 0 86.373L588.879 565.55l-8.637 8.637-117.466 68.234a60.46 60.46 0 0 1-31.958 11.229z"></path><path d="M728.802 962H252.891A190.883 190.883 0 0 1 62.008 771.98V296.934a190.883 190.883 0 0 1 190.883-192.61h267.754a60.46 60.46 0 0 1 0 120.92H252.891a69.962 69.962 0 0 0-69.098 69.099V771.98a69.962 69.962 0 0 0 69.098 69.098h475.911A69.962 69.962 0 0 0 797.9 771.98V503.363a60.46 60.46 0 1 1 120.922 0V771.98A190.883 190.883 0 0 1 728.802 962z"></path></svg><!--]-->Edit this page<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></div><div class="meta-item update-time"><span class="label">Last update: </span><span class="info">9/13/2022, 3:45:15 AM</span></div><div class="meta-item contributors"><span class="label">Contributors: </span><!--[--><!--[--><span class="contributor" title="email: lileicc@gmail.com">Lei Li</span><!--]--><!--]--></div></footer><!----><div class="giscus-wrapper input-top" style="display:block;"><div style="text-align:center">Loading...</div></div><!----><!--]--></main><!--]--><footer class="footer-wrapper"><div class="footer">Li Lab</div><div class="copyright">Copyright © 2023 Bowen Zhang</div></footer><!--]--></div><!--]--><!----><!--]--></div>
    <script type="module" src="/blog/assets/app.4a645708.js" defer></script>
  </body>
</html>
